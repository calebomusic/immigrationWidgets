<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <title>WIDGETS</title>

    <style>
      .grid line {
        stroke: #ccc;
        stroke-dasharray: 1 4;
        stroke-linecap: round;
      }

      .axisX {
        shape-rendering: crispEdges;
      }

      .domain {
        display: none
      }
    </style>
  </head>
  <body>
    <div class="beforeForeignBorn"></div>
    <div id='foreignBorn'></div>
    <div class="beforeGuess"></div>
    <div class="afterGuess"></div>
    <script type'text/javascript'>
      // from 1860 to 2010 (16 points)
      const width = 570,
            height = 340,
            radius = 6,
            numYears =  16,
            margin = {top: 15, right: 20, bottom: 50, left: 70};

      const data = [ { year: '1860', percentage: 13.2 },
                     { year: '1870', percentage: 14.4 },
                     { year: '1880', percentage: 13.3 },
                     { year: '1890', percentage: 14.8 },
                     { year: '1910', percentage: 14.7 },
                     { year: '1920', percentage: 13.2 },
                     { year: '1930', percentage: 11.6 },
                     { year: '1940', percentage: 8.8 },
                     { year: '1950', percentage: 6.9 },
                     { year: '1990', percentage: 13.6 } ]

      var svg = d3.select('#foreignBorn')
        .append('svg:svg')
        .attr('width', width + margin.left + margin.right)
        .attr('height', height + margin.top + margin.bottom)
        .append("g")
        .attr("transform",
          "translate(15,20)")
        .attr('style', "-webkit-tap-highlight-color: rgba(0, 0, 0, 0);");

      var xScale = d3.scaleLinear()
            .domain([1850, 2010])
            .range([0, width])

      var yScale = d3.scaleLinear()
            .domain([0, d3.max(data, (d) => d.percentage)])
            .range([height, 0]);

      drawGrid()
      drawAxes()

      function drawAxes() {
        svg.append("g")
            .attr('class', 'axisX')
            .attr("transform", "translate(0," + height + ")")
            .call(d3.axisBottom(xScale)
                    .tickFormat(d3.format('d'))
                  );
        // y-axis is cut off, NYT doesn't use it.
        // svg.append("g")
          // .call(d3.axisLeft(yScale));
      }

      function make_x_gridlines() {
          return d3.axisBottom(xScale)
              .ticks(6)
      }

      function make_y_gridlines() {
          return d3.axisLeft(yScale)
              .ticks(5)
      }

      // function () {
      //     return d3.axisBottom(xScale)
      //       .ticks(8)
      //       .tickSize(height)
      //       .tickFormat("")
      //     // d3.axisLeft(yScale)
      //     //   .ticks(8)
      //     //   .tickSize(-width)
      //     //   .tickFormat("")
      // }
      function drawGrid () {
        svg.append("g")
              .attr("class", "grid")
              .attr("transform", "translate(0," + height + ")")
              .call(make_x_gridlines()
                  .tickSize(-height)
                  .tickFormat(""))

        svg.append("g")
            .attr("class", "grid")
            .call(make_y_gridlines()
                .tickSize(-width)
                .tickFormat("")
            )
      }

    </script>
  </body>
</html>
